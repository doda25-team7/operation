version: "3.9"

services:
  model-service:
    image: ${MODEL_SERVICE_IMAGE:-ghcr.io/doda25-team7/model-service:${MODEL_SERVICE_TAG:-latest}}
    container_name: model-service
    environment:
      - MODEL_PORT=${MODEL_SERVICE_PORT:-8081}
    expose:
      - "${MODEL_SERVICE_PORT:-8081}"
    volumes:
      - model-service-data:/app/data
    restart: unless-stopped

  app-service:
    image: ${APP_SERVICE_IMAGE:-ghcr.io/doda25-team7/app-service:${APP_SERVICE_TAG:-latest}}
    container_name: app-service
    depends_on:
      - model-service
    environment:
      - APP_PORT=${APP_SERVICE_PORT:-8080}
      - MODEL_HOST=http://model-service:${MODEL_SERVICE_PORT:-8081}
    ports:
      - "${APP_HOST_PORT:-8080}:${APP_SERVICE_PORT:-8080}"
    restart: unless-stopped

volumes:
  model-service-data: